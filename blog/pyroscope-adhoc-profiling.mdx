---
title: Introducing Pyroscope adhoc profiling
sidebar_label: Introducing Pyroscope adhoc profiling
slug: /pyroscope-adhoc-profiling
date: "2022-01-26"
---

# Introducing Pyroscope Adhoc Profiling!

With the recent popularity of *continuous profiling* it may seem as though profiling is a new technology in the observability world. In actuality, profiling has been around for *decades* and larger  companies like [Google](https://research.google/pubs/pub36575/), [Netflix](https://www.brendangregg.com/blog/2015-02-27/linux-profiling-at-netflix.html), and others have even been using continuous profiling in some form for over a decade. 

With companies like these using continuous profiling, clearly it has a lot of potential value. When we created Pyroscope, we did so with the intention to bring the same cost savings, but more importantly debugging capabilities to *all* companies through making Pyroscope an open source continuous profiling solution.

If we were building everything from scratch this would be very unfeasible to do. However, our goal was, and still is, to make Pyroscope a one-stop shop for profiling. And thanks to the open source contributions from hundreds of contributors of the projects that Pyroscope relies on we now support continuous profiling the following languages:

- Go
- Python
- ruby
- eBPF
- .NET
- Java
- Php
- Rust

Like any good open source project we built on the many open source profilers that came before us and so this would not have been possible without the hard work of :

- Brendan Gregg — inventor of Flame Graphs
- Julia Evans — creator of rbspy — sampling profiler for Ruby
- Vladimir Agafonkin — creator of flamebearer — fast flamegraph renderer
- Ben Frederickson — creator of py-spy — sampling profiler for Python
- Adam Saponara — creator of phpspy — sampling profiler for PHP
- Alexei Starovoitov, Brendan Gregg, and many others who made BPF based profiling in Linux kernel possible
- and many more

### Continuous vs Adhoc Profiling

Typically, the profilers mentioned above have been built for more static or adhoc analysis (i.e. profiling a script) as opposed to Pyroscope’s version which added the dimension of time which allows people to do a more continuous analysis (i.e. profiling a server). 

Over time as we continued to improve on the UI/UX of Pyroscope and [dogfooding our own product](profile-continuous-profiler) we started to realize that there are a lot of situations where its actually ideal to use profiling in this static manner vs running a profiler continuously. 

Again our goal is to make Pyroscope a one-stop-shop for *all* profiling needs... And that means supporting all languages, all flamegraph formats, continuously profiling a servers, and -- the topic of this post -- quickly profiling an adhoc script.

### Introducing Adhoc profiling

That being said, we are excited to officially release Adhoc profiling mode for Pyroscope! With this mode you get all the convenience and simplicity of profiling a script and also get the visualization/UI functionality that we’ve built out over the life of Pyroscope.

### Exporting interactive Flamegraph HTML from Pyroscope Adhoc mode

You can use a Pyroscope command to profile a script and export an HTML file which contains an interactive profile that you can view, play with, and share with your team. 

For example, in Go to profile a script you simply run:

```sh
pyroscope adhoc go run adhoc-push.go
```
which will produce a folder containing a `.html` file with an interactive flamegraph (for each of the pprof profiles)
![image](https://user-images.githubusercontent.com/23323466/151047215-4cce89a1-4403-48c6-92b0-b6f1291af7c5.png)

This comand will profile the file passed in and then export an html file which looks like the Pyroscope UI, but is a simple standalone HTML file:
![image](https://user-images.githubusercontent.com/23323466/151047638-f79db7c0-945e-4862-9c34-1654c89782fa.png)

This is the simplest way to use Pyroscope adhoc mode and is great for quickly viewing and sharing profiles. However, one of the benefits of running a Pyroscope server is that it also has a built in database that allows you to store these exported flamegraphs and revisit them later.

### Uploading Alternative Flamegraph formats (i.e. pprof)
If you run:
```
pyroscope server
```
And go to port `:4040`, you will see a web interface where you can drag and drop flamegraphs into the UI and interact with them on the page. 

If you’ve using profiling before, no matter what tool you were using you likely have some stray flamegraph files floating around...

Pyroscope adhoc mode allows you to both view and store those profiles in a centralized place so you can analyze them and compare them to future profiles! 

Simply choose the “upload” tab and either select or drag-an-drop a profile [supported formats](documentation for adhoc) onto the page.

[ Gif of Drag and drop ]

### Analyzing Pyroscope-generated Adhoc Flamegraphs
Pyroscope stores data in the `~/.pyroscope/` directory. If you run:
```
pyroscope server
```
And go to port `:4040`, you will see a web interface that you can use to view and interact with the flamegraphs you have created via the `pyroscope adhoc` command.
![2022-01-25 11 55 01](https://user-images.githubusercontent.com/23323466/151049856-f2388755-97ca-40e7-9af7-ba6f374f1b89.gif)


### Viewing Flamgraph diffs between two adhoc profiles
Similar to how we have diff view for continuous profiling. Adhoc also supports calculating the diff between two Flamegraphs. 
For now this functionality requires server-side code so it is only available for files saved inthe `~/.pyroscope` directory. However, we plan to improve on this over time (or potentially even compile these functions to [WASM](link to issue) — but thats another post for a nother time).
[ show gif calculating diff ]
